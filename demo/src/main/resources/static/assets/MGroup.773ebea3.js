import{i as e,B as t,p as a,d as l,r as s,o as i,c as o,a as d,t as m,C as r,D as n,w as u,h}from"./vendor.7d6c6094.js";const p={name:"MGroup",path:"/manage/:id",inject:["reload"],data:()=>({memberVisible:!1,route:e(),groupName:"",groupID:"",taskList:[],memberList:[],Mem:{memid:"",memname:""},taskVisible:!1,taskInfo:{name:"",mode:"",user:""},nameVisible:!1,memName:"",edit3:!1}),mounted(){this.groupID=this.route.params.id,this.$axios.get("http://localhost:9000/manage/getName",{params:{id:this.route.params.id}}).then((e=>{null!==e.data&&(this.groupName=e.data)})).catch((e=>{this.$message.error("出错了！")})),this.$axios.get("http://localhost:9000/manage/getTask",{params:{id:this.route.params.id}}).then((e=>{if(null!==e.data){this.taskList=[];for(let t=0;t<e.data.length;t++)this.taskList.push(e.data[t])}})).catch((e=>{this.$message.error("出错了！")}))},methods:{altername(){this.$axios.get("http://localhost:9000/manage/altername",{params:{userid:localStorage.getItem("userId"),id:this.route.params.id}}).then((e=>{this.memName=e.data})).catch((e=>{this.$message.error("出错了！")})),this.nameVisible=!0},alter(){""!==this.memName?this.$axios.post("http://localhost:9000/manage/alter",{memname:this.memName,groupid:this.route.params.id,memid:localStorage.getItem("userId")}).then((e=>{"success"===e.data?t.success("成功修改名称"):t.error("修改名称出错")})).catch((e=>{this.$message.error("出错了！")})):t.error("群内昵称不能为空")},addTask(){this.taskVisible=!0},member(){this.$axios.get("http://localhost:9000/manage/getMember",{params:{id:this.route.params.id}}).then((e=>{if(null!==e.data){this.memberList=[];for(let t=0;t<e.data.length;t++)this.memberList.push(e.data[t])}})).catch((e=>{this.$message.error("出错了！")})),this.memberVisible=!0},addMan(){this.$prompt("请输入要添加管理员的id(电话)","创建管理员",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^1[3-9]\d{9}$/,inputErrorMessage:"管理员id格式不正确"}).then((({value:e})=>{this.$axios.post("http://localhost:9000/manage/addManager",{memid:e,groupid:this.route.params.id}).then((e=>{"success"===e.data&&(this.$message({type:"success",message:"添加管理员成功"}),this.reload())})).catch((e=>{t.error("出错了")}))})).catch((()=>{this.$message.error("添加管理员失败")}))},onSubmit(){},delMem(e,a){Object.keys(this.Mem).forEach((e=>{this.Mem[e]=a[e]})),this.$axios.post("http://localhost:9000/manage/delMember",{memid:this.Mem.memid,groupid:this.route.params.id}).then((e=>{"success"===e.data&&(t.success("成功删除"),this.reload())})).catch((e=>{this.$message.error("出错了！")}))}}},c=u();a("data-v-6393a01c");const f={slot:"header",class:"clearfix"},g={class:"box-title"},b={class:"text",style:{"margin-left":"50px"}},k=h("修改群内名称"),y=h("查看成员"),V=h("添加管理员"),x={style:{display:"none"}},_={style:{"font-size":"16px"}},w=h(" 查看 "),$={style:{display:"none"}},I={style:{"font-size":"16px"}},C=h(" 删除 "),M=h("立即创建"),N=h("取消"),v={style:{"font-size":"16px","margin-bottom":"20px"}},z={style:{"margin-left":"20px"}},L={class:"dialog-footer"},U=h("取 消"),T=h("提交");l();const D=c(((e,t,a,l,u,h)=>{const p=s("el-button"),D=s("el-table-column"),S=s("router-link"),j=s("el-table"),B=s("el-card"),E=s("el-dialog"),G=s("el-input"),O=s("el-form-item"),P=s("el-option"),q=s("el-select"),A=s("el-form");return i(),o("div",null,[d(B,{class:"box-card"},{default:c((()=>[d("div",f,[d("span",g,m(u.groupName),1),d("span",b,"群组id："+m(u.groupID),1),d(p,{style:{float:"right","font-size":"16px"},type:"text",onClick:t[1]||(t[1]=e=>h.altername())},{default:c((()=>[k])),_:1}),d(p,{style:{float:"right","font-size":"16px","text-align":"center","padding-right":"30px"},type:"text",onClick:t[2]||(t[2]=e=>h.member())},{default:c((()=>[y])),_:1}),d(p,{style:{float:"right","font-size":"16px","padding-right":"30px","text-align":"center"},type:"text",onClick:t[3]||(t[3]=e=>h.addMan())},{default:c((()=>[V])),_:1})]),d(j,{"show-header":!1,data:u.taskList,style:{width:"100%"},"highlight-current-row":""},{default:c((()=>[d(D,{width:"10"},{default:c((e=>[d("span",x,m(e.row.id),1)])),_:1}),d(D,null,{default:c((e=>[d("div",_,m(e.row.title),1)])),_:1}),d(D,{width:"150",align:"center"},{default:c((e=>[d(S,{to:"/task/"+e.row.id},{default:c((()=>[d(p,{type:"primary",size:"small",style:{width:"100%"}},{default:c((()=>[w])),_:1})])),_:2},1032,["to"])])),_:1})])),_:1},8,["data"])])),_:1}),d(E,{title:"成员列表",modelValue:u.memberVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>u.memberVisible=e)},{default:c((()=>[d(j,{data:u.memberList,"show-header":!1,"highlight-current-row":""},{default:c((()=>[d(D,{width:"10"},{default:c((e=>[d("span",$,m(e.row.memid),1)])),_:1}),d(D,null,{default:c((e=>[d("span",I,m(e.row.memname),1)])),_:1}),d(D,{width:"150",align:"center"},{default:c((e=>[d(p,{type:"danger",size:"small",style:{width:"100%"},onClick:t=>h.delMem(e.$index,e.row)},{default:c((()=>[C])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue"]),d(p,{type:"primary",icon:"el-icon-plus",circle:"",class:"button",onClick:t[5]||(t[5]=e=>h.addTask())}),d(E,{title:"创建任务",modelValue:u.taskVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>u.taskVisible=e)},{default:c((()=>[d(A,{model:u.taskInfo},{default:c((()=>[d(O,{label:"任务名称"},{default:c((()=>[d(G,{modelValue:u.taskInfo.name1,"onUpdate:modelValue":t[6]||(t[6]=e=>u.taskInfo.name1=e)},null,8,["modelValue"])])),_:1}),d(O,{label:"任务模板"},{default:c((()=>[d(q,{modelValue:u.taskInfo.mode,"onUpdate:modelValue":t[7]||(t[7]=e=>u.taskInfo.mode=e),placeholder:"请选择模板"},{default:c((()=>[d(P,{label:"健康码",value:"healthCode"}),d(P,{label:"行程码",value:"wayCode"})])),_:1},8,["modelValue"])])),_:1}),d(O,null,{default:c((()=>[d(O,{label:"发起成员"},{default:c((()=>[d(G,{modelValue:u.taskInfo.user,"onUpdate:modelValue":t[8]||(t[8]=e=>u.taskInfo.user=e)},null,8,["modelValue"])])),_:1})])),_:1}),d(O,null,{default:c((()=>[d(p,{type:"primary",onClick:t[9]||(t[9]=e=>h.onSubmit())},{default:c((()=>[M])),_:1}),d(p,null,{default:c((()=>[N])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),d(E,{title:"修改名称",modelValue:u.nameVisible,"onUpdate:modelValue":t[14]||(t[14]=e=>u.nameVisible=e)},{footer:c((()=>[d("span",L,[d(p,{onClick:t[13]||(t[13]=e=>u.nameVisible=!1)},{default:c((()=>[U])),_:1}),d(p,{type:"primary",onClick:h.alter},{default:c((()=>[T])),_:1},8,["onClick"])])])),default:c((()=>[d(A,null,{default:c((()=>[d("div",v,[r(d("span",null,m(u.memName),513),[[n,!u.edit3]]),r(d(G,{type:"text",modelValue:u.memName,"onUpdate:modelValue":t[11]||(t[11]=e=>u.memName=e),style:{width:"150px"}},null,8,["modelValue"]),[[n,u.edit3]]),d("span",z,[d(p,{type:"primary",icon:{"el-icon-edit":!u.edit3,"el-icon-check":u.edit3},circle:"",size:"mini",onClick:t[12]||(t[12]=e=>u.edit3=!u.edit3)},null,8,["icon"])])])])),_:1})])),_:1},8,["modelValue"])])}));p.render=D,p.__scopeId="data-v-6393a01c";export default p;
