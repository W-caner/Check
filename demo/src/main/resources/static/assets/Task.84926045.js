import{i as t,B as e,p as s,a,r as i,o,c as l,f as d,t as r,C as n,D as h,w as c,h as p}from"./vendor.d4ba3cb4.js";import{_ as u}from"./vue-schart.5df8348b.js";import"./index.00ca952c.js";import"public/icon.ico";const m={name:"Task",path:"/task/:id",inject:["reload"],components:{Schart:u},data:()=>({options3:{type:"pie",legend:{position:"left"},bgColor:"#fbfbfb",labels:["已通过","未通过","未填写"],datasets:[{data:[0,0,0]}]},route:t(),task:{taskname:"",starttime:"",endtime:"",isFinish:!1},memberList:[],isedit:!1,memberTitle:"",photo:{pUrl:"",pResult:"",pid:""},picture:{id:"",name:"",isFinish:!1,isPass:!1},edit1:!1}),mounted(){this.$axios.get("http://localhost:9000/task/getTaskInfo",{params:{id:this.route.params.id}}).then((t=>{null!==t.data&&(this.task.taskname=t.data.title,this.task.description=t.data.description,this.task.starttime=t.data.publishtime,this.task.endtime=t.data.endtime,(t=>{var e=new Date;t=t.replace(/-/g,"/");var s=new Date(t);return!(e.getTime()>s.getTime())})(t.data.endtime)?this.task.isFinish=!1:this.task.isFinish=!0)})).catch((t=>{this.$message.error("出错了！")})),this.$axios.get("http://localhost:9000/pic/getPicUnPass",{params:{id:this.route.params.id}}).then((t=>{this.options3.datasets[0].data[1]=t.data.length})).catch((t=>{this.$message.error("出错了！")})),this.$axios.get("http://localhost:9000/pic/getPicUnFinish",{params:{id:this.route.params.id}}).then((t=>{this.options3.datasets[0].data[2]=t.data.length})).catch((t=>{this.$message.error("出错了！")})),this.$axios.get("http://localhost:9000/pic/getPicPass",{params:{id:this.route.params.id}}).then((t=>{this.options3.datasets[0].data[0]=t.data.length})).catch((t=>{this.$message.error("出错了！")})),this.$axios.get("http://localhost:9000/pic/getPic",{params:{id:this.route.params.id}}).then((t=>{for(let s=0;s<t.data.length;s++){var e={id:t.data[s].picid,name:t.data[s].userid,isFinish:!1,isPass:!1};"2"===t.data[s].result&&(e.isFinish=!0),"1"===t.data[s].result&&(e.isPass=!0),this.memberList.push(e)}})).catch((t=>{this.$message.error("出错了！")}))},watch:{$route(){this.reload()}},methods:{taskC(t,e){this.isedit=!0,Object.keys(this.picture).forEach((t=>{this.picture[t]=e[t]})),this.$axios.get("http://localhost:9000/pic/getPicD",{params:{id:this.picture.id}}).then((t=>{this.photo.pid=t.data.picid,this.photo.pUrl=t.data.photo,"0"===t.data.result?this.photo.pResult="未通过":"1"===t.data.result&&(this.photo.pResult="已通过")})).catch((t=>{this.$message.error("出错了！")}))},sub(){this.$axios.get("http://localhost:9000/pic/alterR",{params:{picid:this.photo.pid,result:"未通过"===this.photo.pResult?"0":"1"}}).then((t=>{"success"===t.data?(e.success("成功修改结果"),this.isedit=!1,this.reload()):(e.error("修改结果失败"),this.isedit=!1)})).catch((t=>{this.$message.error("出错了！")}))},notice(){},FormatTime(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},finish(){this.$confirm("是否现在结束该任务?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("http://localhost:9000/task/endTask",{taskid:this.route.params.id,endtime:this.FormatTime(Date.now())}).then((t=>{"success"===t.data?(e.success("任务已结束"),this.reload()):e.error("结束任务失败")})).catch((t=>{this.$message.error("出错了！")}))})).catch((()=>{}))}}},f=c();s("data-v-438e79a7");const g={class:"user-info"},k={class:"user-info-cont"},x={style:{"font-size":"25px",color:"#222","margin-bottom":"5px"}},b=p("结束"),y={class:"user-info-list"},v=p(" 开始时间： "),w={class:"user-info-list"},_=p(" 结束时间： "),$=d("div",{class:"clearfix"},[d("div",{style:{"font-size":"18px"}},"统计结果")],-1),F={class:"clearfix"},T=d("span",{style:{"font-size":"18px"}},"完成情况",-1),C=p("通知未完成成员"),P={style:{display:"none"}},V=p(" 查看 "),U=d("div",{slot:"error",class:"image-slot"},[d("i",{class:"el-icon-picture-outline"})],-1),z={style:{"font-size":"16px","margin-top":"10px"}},R=p(" 识别结果： "),D={style:{"margin-left":"20px"}},j={class:"dialog-footer"},B=p("取 消"),I=p("提交");a();const L=f(((t,e,s,a,c,p)=>{const u=i("el-button"),m=i("el-card"),L=i("schart"),M=i("el-col"),S=i("el-table-column"),E=i("el-checkbox"),H=i("el-table"),O=i("el-row"),Y=i("el-image"),q=i("el-option"),A=i("el-select"),G=i("el-form"),J=i("el-dialog");return o(),l("div",null,[d(O,{gutter:20},{default:f((()=>[d(M,{span:8},{default:f((()=>[d(m,{style:{"margin-bottom":"20px"},shadow:"hover"},{default:f((()=>[d("div",g,[d("div",k,[d("div",null,[d("span",x,r(c.task.taskname),1),d(u,{type:"danger",onClick:e[1]||(e[1]=t=>p.finish()),size:"mini",style:{float:"right"},class:{isTfinish:c.task.isFinish}},{default:f((()=>[b])),_:1},8,["class"])])])]),d("div",y,[v,d("span",null,r(c.task.starttime),1)]),d("div",w,[_,d("span",null,r(c.task.endtime),1)])])),_:1}),d(m,{shadow:"hover"},{header:f((()=>[$])),default:f((()=>[d(L,{class:"schart",canvasId:"pie",options:c.options3},null,8,["options"])])),_:1})])),_:1}),d(M,{span:16},{default:f((()=>[d(m,{shadow:"hover"},{header:f((()=>[d("div",F,[T,d(u,{style:{float:"right",padding:"3px 0"},type:"text",onClick:e[2]||(e[2]=t=>p.notice())},{default:f((()=>[C])),_:1})])])),default:f((()=>[d(H,{"show-header":!1,data:c.memberList,style:{width:"100%"}},{default:f((()=>[d(S,{width:"1"},{default:f((t=>[d("span",P,r(t.row.id),1)])),_:1}),d(S,{width:"1"},{default:f((t=>[d(E,{modelValue:t.row.isFinish,"onUpdate:modelValue":e=>t.row.isFinish=e,style:{display:"none"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),d(S,null,{default:f((t=>[d("div",{style:{"font-size":"16px"},class:{isfinish:t.row.isPass}},r(t.row.name),3)])),_:1}),d(S,{width:"150",align:"center"},{default:f((t=>[d(u,{type:"primary",size:"small",style:{width:"100%"},onClick:e=>p.taskC(t.$index,t.row),disabled:t.row.isFinish},{default:f((()=>[V])),_:2},1032,["onClick","disabled"])])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1}),d(J,{title:c.memberTitle,modelValue:c.isedit,"onUpdate:modelValue":e[7]||(e[7]=t=>c.isedit=t)},{footer:f((()=>[d("span",j,[d(u,{onClick:e[5]||(e[5]=t=>c.isedit=!1)},{default:f((()=>[B])),_:1}),d(u,{type:"primary",onClick:e[6]||(e[6]=t=>p.sub())},{default:f((()=>[I])),_:1})])])),default:f((()=>[d(G,null,{default:f((()=>[d(Y,{src:c.photo.pUrl},{default:f((()=>[U])),_:1},8,["src"]),d("div",z,[R,n(d("span",null,r(c.photo.pResult),513),[[h,!c.edit1]]),n(d(A,{type:"text",modelValue:c.photo.pResult,"onUpdate:modelValue":e[3]||(e[3]=t=>c.photo.pResult=t),style:{width:"150px"}},{default:f((()=>[d(q,{label:"未通过",value:"未通过"}),d(q,{label:"已通过",value:"已通过"})])),_:1},8,["modelValue"]),[[h,c.edit1]]),d("span",D,[d(u,{type:"primary",icon:{"el-icon-edit":!c.edit1,"el-icon-check":c.edit1},circle:"",size:"mini",onClick:e[4]||(e[4]=t=>c.edit1=!c.edit1)},null,8,["icon"])])])])),_:1})])),_:1},8,["title","modelValue"])])}));m.render=L,m.__scopeId="data-v-438e79a7";export default m;
