{
  "version": 3,
  "sources": ["../js-table2excel/index.js", "dep:js-table2excel"],
  "sourcesContent": ["/* eslint-disable */\r\nlet idTmr;\r\nconst getExplorer = () => {\r\n\tlet explorer = window.navigator.userAgent;\r\n\t//ie\r\n\tif (explorer.indexOf(\"MSIE\") >= 0) {\r\n\t\treturn 'ie';\r\n\t}\r\n\t//firefox\r\n\r\n\telse if (explorer.indexOf(\"Firefox\") >= 0) {\r\n\t\treturn 'Firefox';\r\n\t}\r\n\t//Chrome\r\n\telse if (explorer.indexOf(\"Chrome\") >= 0) {\r\n\t\treturn 'Chrome';\r\n\t}\r\n\t//Opera\r\n\telse if (explorer.indexOf(\"Opera\") >= 0) {\r\n\t\treturn 'Opera';\r\n\t}\r\n\t//Safari\r\n\telse if (explorer.indexOf(\"Safari\") >= 0) {\r\n\t\treturn 'Safari';\r\n\t}\r\n}\r\n// \u5224\u65AD\u6D4F\u89C8\u5668\u662F\u5426\u4E3AIE\r\nconst exportToExcel = (data, name) => {\r\n\r\n\t// \u5224\u65AD\u662F\u5426\u4E3AIE\r\n\tif (getExplorer() == 'ie') {\r\n\t\ttableToIE(data, name)\r\n\t} else {\r\n\t\ttableToNotIE(data, name)\r\n\t}\r\n}\r\n\r\nconst Cleanup = () => {\r\n\twindow.clearInterval(idTmr);\r\n}\r\n\r\n// ie\u6D4F\u89C8\u5668\u4E0B\u6267\u884C\r\nconst tableToIE = (data, name) => {\r\n\tlet curTbl = data;\r\n\tlet oXL = new ActiveXObject(\"Excel.Application\");\r\n\r\n\t//\u521B\u5EFAAX\u5BF9\u8C61excel\r\n\tlet oWB = oXL.Workbooks.Add();\r\n\t//\u83B7\u53D6workbook\u5BF9\u8C61\r\n\tlet xlsheet = oWB.Worksheets(1);\r\n\t//\u6FC0\u6D3B\u5F53\u524Dsheet\r\n\tlet sel = document.body.createTextRange();\r\n\tsel.moveToElementText(curTbl);\r\n\t//\u628A\u8868\u683C\u4E2D\u7684\u5185\u5BB9\u79FB\u5230TextRange\u4E2D\r\n\tsel.select;\r\n\t//\u5168\u9009TextRange\u4E2D\u5185\u5BB9\r\n\tsel.execCommand(\"Copy\");\r\n\t//\u590D\u5236TextRange\u4E2D\u5185\u5BB9\r\n\txlsheet.Paste();\r\n\t//\u7C98\u8D34\u5230\u6D3B\u52A8\u7684EXCEL\u4E2D\r\n\r\n\toXL.Visible = true;\r\n\t//\u8BBE\u7F6Eexcel\u53EF\u89C1\u5C5E\u6027\r\n\r\n\ttry {\r\n\t\tlet fname = oXL.Application.GetSaveAsFilename(\"Excel.xls\", \"Excel Spreadsheets (*.xls), *.xls\");\r\n\t} catch (e) {\r\n\t\tprint(\"Nested catch caught \" + e);\r\n\t} finally {\r\n\t\toWB.SaveAs(fname);\r\n\r\n\t\toWB.Close(savechanges = false);\r\n\t\t//xls.visible = false;\r\n\t\toXL.Quit();\r\n\t\toXL = null;\r\n\t\t// \u7ED3\u675Fexcel\u8FDB\u7A0B\uFF0C\u9000\u51FA\u5B8C\u6210\r\n\t\twindow.setInterval(\"Cleanup();\", 1);\r\n\t\tidTmr = window.setInterval(\"Cleanup();\", 1);\r\n\t}\r\n}\r\n\r\n// \u975Eie\u6D4F\u89C8\u5668\u4E0B\u6267\u884C\r\nconst tableToNotIE = (function () {\r\n\t// \u7F16\u7801\u8981\u7528utf-8\u4E0D\u7136\u9ED8\u8BA4gbk\u4F1A\u51FA\u73B0\u4E2D\u6587\u4E71\u7801\r\n\tconst uri = 'data:application/vnd.ms-excel;base64,',\r\n\t\ttemplate = '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta charset=\"UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>';\r\n\r\n\tconst base64 = function (s) {\r\n\t\treturn window.btoa(unescape(encodeURIComponent(s)));\r\n\t}\r\n\r\n\tconst format = (s, c) => {\r\n\t\treturn s.replace(/{(\\w+)}/g,\r\n\t\t\t(m, p) => {\r\n\t\t\t\treturn c[p];\r\n\t\t\t})\r\n\t}\r\n\r\n\treturn (table, name) => {\r\n\t\tconst ctx = {\r\n\t\t\tworksheet: name,\r\n\t\t\ttable\r\n\t\t}\r\n\r\n\t\tconst url = uri + base64(format(template, ctx));\r\n\r\n\t\tif (navigator.userAgent.indexOf(\"Firefox\") > -1){\r\n\t\t\twindow.location.href = url\r\n\t\t} else {\r\n\t\t\tconst aLink = document.createElement('a');\r\n\t\t\taLink.href = url;\r\n\t\t\taLink.download = name || '';\r\n\t\t\tlet event;\r\n\t\t\tif (window.MouseEvent) {\r\n\t\t\t\tevent = new MouseEvent('click');\r\n\t\t\t} else {\r\n\t\t\t\tevent = document.createEvent('MouseEvents');\r\n\t\t\t\tevent.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\r\n\t\t\t}\r\n\t\t\taLink.dispatchEvent(event);\r\n\t\t}\r\n\t}\r\n})()\r\n\r\n// \u5BFC\u51FA\u51FD\u6570\r\nconst table2excel = (column, data, excelName) => {\r\n\tconst typeMap = {\r\n\t\timage: getImageHtml,\r\n\t\ttext: getTextHtml\r\n\t}\r\n\r\n\tlet thead = column.reduce((result, item) => {\r\n\t\tresult += `<th>${item.title}</th>`\r\n\t\treturn result\r\n\t}, '')\r\n\r\n\tthead = `<thead><tr>${thead}</tr></thead>`\r\n\r\n\tlet tbody = data.reduce((result, row) => {\r\n\t\tconst temp = column.reduce((tds, col) => {\r\n\t\t\ttds += typeMap[col.type || 'text'](row[col.key], col)\r\n\t\t\treturn tds\r\n\t\t}, '')\r\n\t\tresult += `<tr>${temp}</tr>`\r\n\t\treturn result\r\n\t}, '')\r\n\r\n\ttbody = `<tbody>${tbody}</tbody>`\r\n\r\n\tconst table = thead + tbody\r\n\r\n\t// \u5BFC\u51FA\u8868\u683C\r\n\texportToExcel(table, excelName)\r\n\r\n\tfunction getTextHtml(val) {\r\n\t\treturn `<td style=\"text-align: center\">${val}</td>`\r\n\t}\r\n\r\n\tfunction getImageHtml(val, options) {\r\n\t\toptions = Object.assign({width: 40, height: 60}, options)\r\n\t\treturn `<td style=\"width: ${options.width}px; height: ${options.height}px; text-align: center; vertical-align: middle\"><img src=\"${val}\" width=${options.width} height=${options.height}></td>`\r\n\t}\r\n}\r\n\r\nexport default table2excel\r\n", "import d from \"./node_modules/js-table2excel/index.js\";export default d;"],
  "mappings": "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",
  "names": []
}
