import{aj as e,ah as t,ao as s,ag as a,G as i,O as l,q as o,aI as d,aX as r,aJ as n,N as p}from"./@vue.c261c184.js";import{a as h}from"./vue-router.f985018f.js";import{w as c}from"./element-plus.d6772035.js";import"./side-channel.ae62d9bb.js";import"./qs.dd4863fa.js";import{E as m}from"./axios.df2521e5.js";import"./resize-observer-polyfill.96acbc9d.js";import"./lodash.c042e748.js";import"./normalize-wheel.86fce3c7.js";import"./mitt.20cc8481.js";import"./dayjs.1c7a45b9.js";import"./async-validator.3a3a8ce1.js";import"./@popperjs.59bfb2c1.js";import"./get-intrinsic.6937319b.js";import"./has-symbols.66aa3060.js";import"./function-bind.3516d9d0.js";import"./has.e5e9094d.js";import"./call-bind.d7be007a.js";const u={name:"Agroup",path:"/add/:id",inject:["reload"],data:()=>({groupID:"",resData:{userId:localStorage.getItem("userid")},route:h(),groupName:"",taskList:[],editTaskVisible:!1,dialogtitle:"",task:{id:"",title:"",description:""},nameVisible:!1,memName:"",edit2:!1,fileLists:[],photo:{pUrl:"",pResult:"",pid:""},photofirst:{pUrl:"",pResult:"",pid:""},Visible:!1,currentPage:1,totalCount:1,second:!1,photo:{pUrl:"",pResult:"",pid:""}}),mounted(){this.groupID=this.route.params.id,this.$axios.get("http://localhost:9000/add/getName",{params:{id:this.route.params.id}}).then((e=>{null!==e.data&&(this.groupName=e.data)})).catch((e=>{this.$message.error("出错了！"),console.log(e)})),this.$axios.get("http://localhost:9000/add/getTask",{params:{id:this.route.params.id,userid:localStorage.getItem("userId")}}).then((e=>{if(null!==e.data){for(let t=0;t<e.data.length;t++){let s={id:0,title:"",isFinish:!1,isEnd:!1};s.id=e.data[t].taskid,s.title=e.data[t].title,1===e.data[t].ifend&&(s.isEnd=!0),this.taskList.push(s)}this.totalCount=e.data.length}})).catch((e=>{this.$message.error("出错了！"),console.log(e)}))},watch:{$route(){this.reload()}},methods:{handleSizeChange(e){this.pageSize=e,this.currentPage=1},handlecurrentChange(e){this.currentPage=e},write(e,t){Object.keys(this.task).forEach((e=>{this.task[e]=t[e]})),this.$axios.get("http://localhost:9000/task/getTaskInfo",{params:{id:this.task.id}}).then((e=>{this.task.description=e.data.description,this.$axios.get("http://localhost:9000/pic/second",{params:{userid:localStorage.getItem("userId"),taskid:this.task.id}}).then((e=>{if("2"===e.data.result)return void(this.second=!1);"1"===e.data.result?(this.photofirst.pResult="已通过",this.second=!0):(this.photofirst.pResult="未通过",this.second=!0),this.photofirst.pid=e.data.picid;let t=e.data.photo.split("\\");this.photofirst.pUrl="http://localhost:9000/pics/"+t[t.length-1],console.log(this.photofirst.pUrl)})).catch((e=>{this.$message.error("出错了！"),console.log(e)}))})).catch((e=>{this.$message.error("出错了！"),console.log(e)})),this.editTaskVisible=!0},handleChange(e){this.fileLists=[],this.fileLists.push(e)},handleRemove(){this.fileLists.pop()},submit(e){let t=new FormData;t.append("file",this.fileLists[0].raw),t.append("userid",localStorage.getItem("userId")),t.append("taskid",this.task.id),t.append("type",this.task.description),m.defaults.headers.post["Content-Type"]="application/form-data;charset=UTF-8",this.$axios.post("http://localhost:9000/pic/add",t).then((e=>{this.photo.pResult=e.data,this.Visible=!0})).catch((e=>{console.log(e)}))},submitSuccess(e,t,s){this.$message({message:"上传成功",type:"success"})},submitPhoto(e){this.editTaskVisible=!1},altername(){this.$axios.get("http://localhost:9000/add/altername",{params:{userid:localStorage.getItem("userId"),id:this.route.params.id}}).then((e=>{this.memName=e.data})).catch((e=>{this.$message.error("出错了！"),console.log(e)})),this.nameVisible=!0},alter(){""!==this.memName?this.$axios.post("http://localhost:9000/add/alter",{memname:this.memName,groupid:this.route.params.id,userid:localStorage.getItem("userId")}).then((e=>{"success"===e.data?c.success("成功修改名称"):c.error("修改名称出错")})).catch((e=>{this.$message.error("出错了！"),console.log(e)})):c.error("群内昵称不能为空")}}},g=n();e("data-v-1ea54811");const f={slot:"header",class:"clearfix"},b={class:"box-title"},k={class:"text",style:{"margin-left":"50px"}},y=p("修改群内名称"),x={style:{display:"none"}},j=p(" 填写 "),V={style:{"font-size":"16px","margin-top":"10px"}},w=p(" 识别结果： "),C=l("i",{class:"el-icon-upload"},null,-1),v=l("div",{class:"el-upload__text"},[p("将文件拖到此处，或"),l("em",null,"点击上传")],-1),_=l("div",{class:"el-upload__tip",slot:"tip"},"只能上传jpg/png文件，且不超过500kb",-1),I={class:"dialog-footer"},$=p("取 消"),z=p("提交"),S={style:{"font-size":"16px","margin-bottom":"20px"}},N={style:{"margin-left":"20px"}},U={class:"dialog-footer"},R=p("取 消"),T=p("提交");t();const L=g(((e,t,n,p,h,c)=>{const m=s("el-button"),u=s("el-table-column"),L=s("el-checkbox"),F=s("el-table"),P=s("el-pagination"),D=s("el-card"),E=s("el-upload"),q=s("el-form"),O=s("el-dialog"),A=s("el-input");return a(),i("div",null,[l(D,{class:"box-card"},{default:g((()=>[l("div",f,[l("span",b,o(h.groupName),1),l("span",k,"群组id："+o(h.groupID),1),l(m,{style:{float:"right","font-size":"16px","padding-right":"30px"},type:"text",onClick:t[1]||(t[1]=e=>c.altername())},{default:g((()=>[y])),_:1})]),l(F,{"show-header":!1,data:h.taskList,style:{width:"100%"},"highlight-current-row":""},{default:g((()=>[l(u,{width:"10"},{default:g((e=>[l("span",x,o(e.row.id),1)])),_:1}),l(u,{width:"10"},{default:g((e=>[l(L,{modelValue:e.row.isFinish,"onUpdate:modelValue":t=>e.row.isFinish=t,style:{display:"none"}},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),l(u,null,{default:g((e=>[l("div",{style:{"font-size":"16px"},class:{isfinish:e.row.isFinish}},o(e.row.title),3)])),_:1}),l(u,{width:"150",align:"center"},{default:g((e=>[l(m,{type:"primary",size:"small",style:{width:"100%"},onClick:t=>c.write(e.$index,e.row),icon:"el-icon-lx-edit ",disabled:e.row.isEnd},{default:g((()=>[j])),_:2},1032,["onClick","disabled"])])),_:1})])),_:1},8,["data"]),l(P,{onSizeChange:c.handleSizeChange,onCurrentChange:c.handlecurrentChange,"current-page":h.currentPage,layout:"total,prev, pager, next, jumper",total:h.totalCount,"hide-on-single-page":!1},null,8,["onSizeChange","onCurrentChange","current-page","total"])])),_:1}),l(O,{title:h.task.title,modelValue:h.editTaskVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>h.editTaskVisible=e)},{footer:g((()=>[l("span",I,[l(m,{onClick:t[2]||(t[2]=e=>h.editTaskVisible=!1)},{default:g((()=>[$])),_:1}),l(m,{type:"primary",onClick:c.submit},{default:g((()=>[z])),_:1},8,["onClick"])])])),default:g((()=>[d(l("div",null,[l("img",{src:h.photofirst.pUrl,style:{width:"100%"}},null,8,["src"]),l("div",V,[w,l("span",null,o(h.photofirst.pResult),1)])],512),[[r,h.second]]),l(q,null,{default:g((()=>[l(E,{class:"upload-demo",drag:"",multiple:"",accept:"image/png,image/jpg,image/jpeg","file-list":h.fileLists,"on-preview":e.handlePreview,"on-success":c.submitSuccess,"on-change":c.handleChange,"on-remove":c.handleRemove,ref:"upload","list-type":"picture","auto-upload":!1,limit:1},{default:g((()=>[C,v,_])),_:1},8,["file-list","on-preview","on-success","on-change","on-remove"])])),_:1}),d(l("div",{style:{"font-size":"16px","margin-top":"10px"}},o(h.photo.pResult),513),[[r,h.Visible]])])),_:1},8,["title","modelValue"]),l(O,{title:"修改名称",modelValue:h.nameVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>h.nameVisible=e)},{footer:g((()=>[l("span",U,[l(m,{onClick:t[6]||(t[6]=e=>h.nameVisible=!1)},{default:g((()=>[R])),_:1}),l(m,{type:"primary",onClick:c.alter},{default:g((()=>[T])),_:1},8,["onClick"])])])),default:g((()=>[l(q,null,{default:g((()=>[l("div",S,[d(l("span",null,o(h.memName),513),[[r,!h.edit2]]),d(l(A,{type:"text",modelValue:h.memName,"onUpdate:modelValue":t[4]||(t[4]=e=>h.memName=e),style:{width:"150px"}},null,8,["modelValue"]),[[r,h.edit2]]),l("span",N,[l(m,{type:"primary",icon:{"el-icon-edit":!h.edit2,"el-icon-check":h.edit2},circle:"",size:"mini",onClick:t[5]||(t[5]=e=>h.edit2=!h.edit2)},null,8,["icon"])])])])),_:1})])),_:1},8,["modelValue"])])}));u.render=L,u.__scopeId="data-v-1ea54811";export default u;
